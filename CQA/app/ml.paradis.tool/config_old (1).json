{
  "configVersion": 1.0,
  "Servers": [
    {
      "Address": "ws://localhost:26481/moyuxu",
      "Passwd": "233",
      "Tag": "23333",
      "Actions": [
        {
          "Type": "DoActions",
          "Filter": {
            "Path": [
              "operate"
            ],
            "Operator": "==",
            "Value": "onmsg"
          },
          "Parameters": {
            "Actions": [
              {
                "Type": "var",
                "Parameters": {
                  "Name": "PlayerName",
                  "Path": [
                    "target"
                  ]
                }
              },
              {
                "Type": "var",
                "Parameters": {
                  "Name": "Message",
                  "Path": [
                    "text"
                  ]
                }
              },
              {
                "Type": "var",
                "Parameters": {
                  "Name": "ServerName",
                  "ServerConfig": [
                    "Tag"
                  ]
                }
              },
              {
                "Type": "ToUnicode",
                "Parameters": {
                  "CreateVariant": "ReturnMessage",
                  "Text": "§e<§6%PlayerName%§e>§b%Message%"
                }
              },
              {
                "Type": "log",
                "Parameters": {
                  "Debug": "[%ServerName%]玩家%PlayerName%发送了消息:%Message%"
                }
              },
              {
                "Type": "other",
                "Parameters": {
                  "cmd": "tellraw @a {\"rawtext\":[{\"text\":\"§a【%ServerName%】%ReturnMessage%\"}]}"
                }
              },
              {
                "Type": "GroupMessage",
                "Parameters": {
                  "GroupID": 233233333,
                  "Message": "[%ServerName%:Chat]%PlayerName%>%Message%"
                }
              }
            ]
          }
        },
        {
          "Type": "DoActions",
          "Filter": {
            "Path": [
              "operate"
            ],
            "Operator": "==",
            "Value": "onjoin"
          },
          "Parameters": {
            "Actions": [
              {
                "Type": "var",
                "Parameters": {
                  "Name": "PlayerName",
                  "Path": [
                    "target"
                  ]
                }
              },
              {
                "Type": "var",
                "Parameters": {
                  "Name": "ServerName",
                  "ServerConfig": [
                    "Tag"
                  ]
                }
              },
              {
                "Type": "log",
                "Parameters": {
                  "Debug": "[%ServerName%]玩家%PlayerName%加入了服务器"
                }
              },
              {
                "Type": "sender",
                "Parameters": {
                  "cmd": "say §e欢迎%PlayerName%§a加入%ServerName%！"
                }
              },
              {
                "Type": "other",
                "Parameters": {
                  "cmd": "say %PlayerName%加入了%ServerName%"
                }
              },
              {
                "Type": "GroupMessage",
                "Parameters": {
                  "GroupID": 233233333,
                  "Message": "[%ServerName%:Join]%PlayerName%加入了服务器"
                }
              }
            ]
          }
        },
        {
          "Type": "DoActions",
          "Filter": {
            "Path": [
              "operate"
            ],
            "Operator": "==",
            "Value": "onleft"
          },
          "Parameters": {
            "Actions": [
              {
                "Type": "var",
                "Parameters": {
                  "Name": "PlayerName",
                  "Path": [
                    "target"
                  ]
                }
              },
              {
                "Type": "var",
                "Parameters": {
                  "Name": "ServerName",
                  "ServerConfig": [
                    "Tag"
                  ]
                }
              },
              {
                "Type": "log",
                "Parameters": {
                  "Debug": "[%ServerName%]玩家%PlayerName%退出了服务器"
                }
              },
              {
                "Type": "sender",
                "Parameters": {
                  "cmd": "say §e真可惜%PlayerName%§a离开了%ServerName%！"
                }
              },
              {
                "Type": "other",
                "Parameters": {
                  "cmd": "say %PlayerName%离开了%ServerName%"
                }
              },
              {
                "Type": "GroupMessage",
                "Parameters": {
                  "GroupID": 233233333,
                  "Message": "[%ServerName%:Left]%PlayerName%离开了服务器"
                }
              }
            ]
          }
        },
        {
          "Type": "DoActions",
          "Filter": {
            "Path": [
              "operate"
            ],
            "Operator": "==",
            "Value": "oncmd"
          },
          "Parameters": {
            "Actions": [
              {
                "Type": "DoActions",
                "Filter": {
                  "Path": [
                    "text"
                  ],
                  "Operator": "==",
                  "Value": "list"
                },
                "Parameters": {
                  "Actions": [
                    {
                      "Type": "var",
                      "Parameters": {
                        "Name": "List_PlayerName",
                        "Path": [
                          "target"
                        ]
                      }
                    },
                    {
                      "Type": "var",
                      "Parameters": {
                        "Name": "List_ServerName",
                        "ServerConfig": [
                          "Tag"
                        ]
                      }
                    },
                    {
                      "Type": "all",
                      "Parameters": {
                        "cmd": "list",
                        "CallbackActions": [
                          {
                            "Type": "var",
                            "Parameters": {
                              "Name": "List_ResultText",
                              "Path": [
                                "text"
                              ]
                            }
                          },
                          {
                            "Type": "var",
                            "Parameters": {
                              "Name": "List_ResultServer",
                              "ServerConfig": [
                                "Tag"
                              ]
                            }
                          },
                          {
                            "Type": "RegexReplace",
                            "Parameters": {
                              "TargetVariant": "List_ResultText",
                              "Pattern": "\n",
                              "Replacement": "§b"
                            }
                          },
                          {
                            "Type": "ToUnicode",
                            "Parameters": {
                              "CreateVariant": "List_ReturnMessage",
                              "Text": "§e[§6%List_ResultServer%§a在线玩家§e]§7%List_ResultText%"
                            }
                          },
                          {
                            "Type": "servers",
                            "Parameters": {
                              "Filter": {
                                "ServerConfig": [
                                  "Tag"
                                ],
                                "Operator": "==",
                                "Value": "%List_ServerName%"
                              },
                              "cmd": "tellraw \"%List_PlayerName%\" {\"rawtext\":[{\"text\":\"%List_ReturnMessage%\"}]}"
                            }
                          }
                        ]
                      }
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    }
  ],
  "CheckConnectionTime": 60,
  "Groups": [
    {
      "ID": 233233333,
      "SendToServer": true,
      "SendToServerRegex": "^(?!/)(.+|\\s+)+",
      "SendToServerFormat": {
        "CQAt": "§r§l§6@§r§6{0}§a",
        "CQImage": "§r§l§d[图骗]§r§a",
        "CQEmoji": "§r§l§d[emoji]§r§a",
        "CQFace": "§r§l§c[表情]§r§a",
        "CQBface": "§r§l§d[大表情:§r§o§7{0}§r§l§d]§r§a",
        "Main": "§b【群聊消息】§e<{0}>§a{1}"
      },
      "Actions": [
        {
          "Type": "var",
          "Parameters": {
            "Name": "Message",
            "Path": [
              "Message"
            ]
          }
        },
        {
          "Type": "RegexGet",
          "Parameters": {
            "TargetVariant": "Message",
            "CreateVariant": "CMDStr",
            "Pattern": "^/(cmd|执行命令)\\s*(23333)?\\s*/?(?<cmdStrGet>.*)",
            "GroupName": "cmdStrGet"
          }
        },
        {
          "Type": "DoActions",
          "Filter": {
            "Variant": "CMDStr",
            "Operator": "!=",
            "Value": ""
          },
          "Parameters": {
            "Actions": [
              {
                "Type": "var",
                "Parameters": {
                  "Name": "MemberType",
                  "Path": [
                    "MemberInfo",
                    "MemberType"
                  ]
                }
              },
              {
                "Type": "RegexGet",
                "Parameters": {
                  "TargetVariant": "Message",
                  "CreateVariant": "SelectedServer",
                  "Pattern": "^/(cmd|执行命令)\\s*(?<Server>23333)",
                  "GroupName": "Server"
                }
              },
              {
                "Type": "DoActions",
                "Filter": {
                  "any_of": [
                    {
                      "Variant": "MemberType",
                      "Operator": "==",
                      "Value": "Creator"
                    },
                    {
                      "Variant": "MemberType",
                      "Operator": "==",
                      "Value": "Manage"
                    }
                  ]
                },
                "Parameters": {
                  "Actions": [
                    {
                      "Type": "var",
                      "Parameters": {
                        "Name": "GroupID",
                        "Path": [
                          "FromGroup"
                        ]
                      }
                    },
                    {
                      "Type": "servers",
                      "Parameters": {
                        "cmd": "%CMDStr%",
                        "Filter": {
                          "any_of": [
                            {
                              "Variant": "SelectedServer",
                              "Operator": "==",
                              "Value": ""
                            },
                            {
                              "ServerConfig": [
                                "Tag"
                              ],
                              "Operator": "==",
                              "Value": "%SelectedServer%"
                            }
                          ]
                        },
                        "CallbackActions": [
                          {
                            "Type": "var",
                            "Parameters": {
                              "Name": "result",
                              "Path": [
                                "text"
                              ]
                            }
                          },
                          {
                            "Type": "var",
                            "Parameters": {
                              "Name": "ServerName",
                              "ServerConfig": [
                                "Tag"
                              ]
                            }
                          },
                          {
                            "Type": "GroupMessage",
                            "Parameters": {
                              "GroupID": "%GroupID%",
                              "Message": "[%ServerName%]命令\"%CMDStr%\"执行成功\n>%result%"
                            }
                          }
                        ]
                      }
                    },
                    {
                      "Type": "log",
                      "Parameters": {
                        "Info": "%SelectedServer%执行命令%CMDStr%"
                      }
                    }
                  ],
                  "MismatchedActions": [
                    {
                      "Type": "ReturnGroupMessageAtFrom",
                      "Parameters": {
                        "Message": "你莫得权限无法执行%CMDStr%"
                      }
                    }
                  ]
                }
              }
            ]
          }
        },
        {
          "Type": "RegexGet",
          "Parameters": {
            "TargetVariant": "Message",
            "CreateVariant": "QueryAction",
            "Pattern": "^/(?<QueryAction>query|查询)",
            "GroupName": "QueryAction"
          }
        },
        {
          "Type": "DoActions",
          "Filter": {
            "Variant": "QueryAction",
            "Operator": "!=",
            "Value": ""
          },
          "Parameters": {
            "Actions": [
              {
                "Type": "RegexGet",
                "Parameters": {
                  "TargetVariant": "Message",
                  "CreateVariant": "QueryServer",
                  "Pattern": "^/(query|查询)\\s*(?<Server>23333)",
                  "GroupName": "Server"
                }
              },
              {
                "Type": "DoActions",
                "Parameters": {
                  "Actions": [
                    {
                      "Type": "var",
                      "Parameters": {
                        "Name": "GroupID",
                        "Path": [
                          "FromGroup"
                        ]
                      }
                    },
                    {
                      "Type": "servers",
                      "Parameters": {
                        "cmd": "list",
                        "Filter": {
                          "any_of": [
                            {
                              "Variant": "QueryServer",
                              "Operator": "==",
                              "Value": ""
                            },
                            {
                              "ServerConfig": [
                                "Tag"
                              ],
                              "Operator": "==",
                              "Value": "%QueryServer%"
                            }
                          ]
                        },
                        "CallbackActions": [
                          {
                            "Type": "var",
                            "Parameters": {
                              "Name": "QueryResult",
                              "Path": [
                                "text"
                              ]
                            }
                          },
                          {
                            "Type": "var",
                            "Parameters": {
                              "Name": "ServerName",
                              "ServerConfig": [
                                "Tag"
                              ]
                            }
                          },
                          {
                            "Type": "GroupMessage",
                            "Parameters": {
                              "GroupID": "%GroupID%",
                              "Message": "[%ServerName%]查询成功\n%QueryResult%"
                            }
                          }
                        ]
                      }
                    },
                    {
                      "Type": "log",
                      "Parameters": {
                        "Info": "查询"
                      }
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    }
  ],
  "Timers": [
    {
      "Interval": 7200,
      "Actions": [
        {
          "Type": "log",
          "Parameters": {
            "Info": "计时器：定时在线查询"
          }
        },
        {
          "Type": "servers",
          "Parameters": {
            "cmd": "list",
            "CallbackActions": [
              {
                "Type": "var",
                "Parameters": {
                  "Name": "result",
                  "Path": [
                    "text"
                  ]
                }
              },
              {
                "Type": "var",
                "Parameters": {
                  "Name": "ServerName",
                  "ServerConfig": [
                    "Tag"
                  ]
                }
              },
              {
                "Type": "GroupMessage",
                "Parameters": {
                  "GroupID": "233233333",
                  "Message": "[%ServerName%]在线定时查询\n>%result%"
                }
              }
            ]
          }
        }
      ]
    }
  ],
  "Tasks": [
    {
      "Mode": "EachHour",
      "Time": 0,
      "Actions": [
        {
          "Type": "log",
          "Parameters": {
            "Info": "[示例Task]现在是整点！"
          }
        }
      ]
    },
    {
      "Mode": "EachHour",
      "Time": 30,
      "Actions": [
        {
          "Type": "log",
          "Parameters": {
            "Info": "[示例Task]现在是半点！"
          }
        }
      ]
    },
    {
      "Mode": "EachDay",
      "Time": 0,
      "Actions": [
        {
          "Type": "log",
          "Parameters": {
            "Info": "美好的一天过去了......"
          }
        }
      ]
    }
  ]
}